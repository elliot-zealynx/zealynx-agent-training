# MCP/Tool-Use Attack Taxonomy

## Attack Categories Overview

This taxonomy organizes all known MCP and tool-use exploitation techniques into comprehensive categories based on attack vectors, targets, and mechanisms.

## Primary Attack Surfaces

### 1. Tool Registration Phase
**Target:** Tool metadata processing during MCP server connection
- **Tool Poisoning** - Malicious instructions in tool descriptions
- **Puppet Attacks** - Manipulation of tool selection through biased descriptions
- **Schema Confusion** - Exploiting similar tool names/parameters
- **Metadata Injection** - Hidden instructions in tool metadata fields

### 2. Tool Execution Phase  
**Target:** Function calling and parameter processing
- **Function Calling Abuse** - Direct exploitation of LLM function calling
- **Parameter Injection** - Malicious parameters passed to legitimate tools
- **Return Value Poisoning** - Malicious content in tool outputs
- **Execution Context Escape** - Breaking out of tool sandboxes

### 3. Tool Orchestration Phase
**Target:** Multi-tool workflows and chaining
- **Cross-Tool Orchestration** - Chaining legitimate tools for malicious goals
- **Workflow Hijacking** - Redirecting planned tool sequences
- **Dependency Confusion** - Exploiting tool interdependencies
- **Cascade Amplification** - Small compromise leading to system-wide impact

### 4. Tool Lifecycle Phase
**Target:** Long-running sessions and persistence
- **Rug Pull Attacks** - Tools changing behavior after trust establishment
- **Session Persistence** - Maintaining compromise across interactions
- **Memory Poisoning** - Corrupting agent memory with malicious context
- **Trust Inheritance** - Exploiting established tool trust relationships

## Attack Vectors by Sophistication

### Level 1: Direct Injection
- **Prompt injection** in tool descriptions
- **Parameter manipulation** in function calls
- **Output tampering** in tool responses
- **Simple payload delivery** through tool interfaces

### Level 2: Orchestrated Attacks
- **Multi-tool coordination** for complex goals
- **Conditional execution** based on agent state
- **Social engineering** through tool interactions
- **Data exfiltration** via tool chaining

### Level 3: Ecosystem Compromise
- **Supply chain poisoning** of MCP servers
- **Network effect exploitation** across agent populations
- **Persistent infrastructure** compromise
- **Advanced persistent threats** (APTs) in agent ecosystems

## Impact Classification

### Confidentiality Breaches
- **Data exfiltration** through compromised tools
- **Credential harvesting** via malicious functions
- **Privacy violations** through unauthorized data access
- **Surveillance** via persistent tool monitoring

### Integrity Violations  
- **Data manipulation** through file system tools
- **Code injection** via development tools
- **Configuration tampering** through system tools
- **Supply chain corruption** via package management tools

### Availability Disruption
- **Service denial** through resource exhaustion
- **System shutdown** via administrative tools
- **Data destruction** through file management tools
- **Network isolation** via network configuration tools

## Defense Layers

### Prevention
1. **Tool Whitelisting** - Only approved MCP servers
2. **Metadata Sanitization** - Clean tool descriptions of injection content
3. **Input Validation** - Strict parameter checking
4. **Least Privilege** - Minimal tool permissions
5. **User Authorization** - Confirmation gates for sensitive operations

### Detection
1. **Behavioral Monitoring** - Track tool usage patterns
2. **Anomaly Detection** - Identify unusual tool call sequences
3. **Intent Verification** - Match tool calls to user requests
4. **Orchestration Analysis** - Detect malicious tool chaining
5. **Context Validation** - Ensure tool actions match conversation context

### Response
1. **Circuit Breakers** - Automatically disable suspicious tools
2. **Rollback Capabilities** - Undo malicious tool actions
3. **Incident Logging** - Comprehensive audit trails
4. **Isolation Mechanisms** - Quarantine compromised tools
5. **Recovery Procedures** - Restore from known-good states

## Attack Economics

### Attacker Costs
- **MCP server deployment** - $10-50/month for basic hosting
- **Tool development** - Hours to days for simple poisoned tools
- **Discovery and targeting** - Automated scanning of MCP endpoints
- **Persistence maintenance** - Ongoing costs for long-term compromise

### Defender Costs  
- **Security tooling** - $1000s for comprehensive MCP monitoring
- **Staff training** - Significant investment in agent security expertise
- **Incident response** - High costs for compromise remediation
- **Compliance** - Regulatory costs for AI system security

## Benchmark Performance Data

### MCPTox Results (August 2025)
- **20 LLM agents tested** across major providers
- **Attack success rates:** 60-72.8% for tool poisoning
- **Refusal rates:** <3% for most advanced models
- **Universal vulnerability** - all tested agents susceptible

### MCPSecBench Results (October 2025)
- **17 attack types** across 4 attack surfaces
- **85% attack success rate** across platforms
- **Universal core vulnerabilities** affecting Claude, OpenAI, Cursor
- **Variable prompt/tool attacks** depending on platform

## Future Attack Trends

### Emerging Techniques
1. **Multi-modal tool exploitation** - Attacks via images/audio in tools
2. **AI-generated tool swarms** - Automated malicious tool creation
3. **Steganographic hiding** - Invisible instructions in tool metadata
4. **Blockchain-based persistence** - Immutable malicious tool registrations

### Scaling Concerns
1. **Tool marketplace pollution** - Widespread malicious tool distribution
2. **Network effect amplification** - Compromise spreading across agent networks
3. **Supply chain centralization** - Single points of failure in MCP ecosystems
4. **Autonomous attack evolution** - Self-improving attack tools

## Zealynx Red Team Methodology

### Assessment Framework
1. **Asset Discovery** - Identify all MCP servers and tools in scope
2. **Attack Surface Mapping** - Catalog registration, execution, orchestration surfaces
3. **Threat Modeling** - Prioritize attack vectors by business impact
4. **Exploitation Testing** - Systematic testing across all attack categories
5. **Impact Analysis** - Quantify potential damage from successful attacks
6. **Defense Evaluation** - Test detection and response capabilities

### Testing Priorities
1. **High-value tool targets** - Email, file system, network, financial tools
2. **Trust boundary exploitation** - Internal vs external tool boundaries  
3. **Privilege escalation paths** - From read-only to administrative access
4. **Persistence mechanisms** - Long-term compromise sustainability
5. **Detection evasion** - Bypassing monitoring and alerting systems

## References

- MCPTox: A Benchmark for Tool Poisoning Attack (arXiv:2508.14925, August 2025)
- MCPSecBench: Systematic Security Benchmark (arXiv:2508.13220, October 2025)
- Beyond the Protocol: MCP Attack Vectors (arXiv:2506.02040, May 2025)
- When MCP Servers Attack: Taxonomy and Mitigation (arXiv:2509.24272, September 2025)
- OWASP Agentic AI Top 10 (December 2025)
- Elastic Security Labs: MCP Attack Analysis (September 2025)